<div class="blog-content-box">
    <div class="article-header-box">
        <div class="article-header">
            <div class="article-title-box">
                <h1 class="title-article" id="articleContentId">Python实现带GUI和连接数据库的图书管理系统</h1>
            </div>
            <div class="article-info-box">
                <div class="article-bar-top">
                    <img class="article-type-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/original.png" alt="">
                    <div class="bar-content">
                    <a class="follow-nickName " href="https://blog.csdn.net/cnmlgbnbcs" target="_blank" rel="noopener">寄居蟹~</a>
                    <span class="time">2020-12-04 17:51:01</span>
                    <img class="article-read-img article-heard-img" src="https://csdnimg.cn/release/blogv2/dist/pc/img/articleReadEyes.png" alt="">
                    <span class="read-count">119</span>
                    <a id="blog_detail_zk_collection" class="un-collection" data-report-click="{&quot;mod&quot;:&quot;popu_823&quot;,&quot;spm&quot;:&quot;1001.2101.3001.4232&quot;,&quot;ab&quot;:&quot;new&quot;}">
                        <img class="article-collect-img article-heard-img un-collect-status isdefault" style="display:inline-block" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollect.png" alt="">
                        <img class="article-collect-img article-heard-img collect-status isactive" style="display:none" src="https://csdnimg.cn/release/blogv2/dist/pc/img/tobarCollectionActive.png" alt="">
                        <span class="name">收藏</span>
                        <span class="get-collection">
                            1
                        </span>
                    </a>
                    </div>
                </div>
                <div class="blog-tags-box">
                    <div class="tags-box artic-tag-box">
                            <span class="label">文章标签：</span>
                                <a data-report-click="{&quot;mod&quot;:&quot;popu_626&quot;,&quot;spm&quot;:&quot;1001.2101.3001.4223&quot;,&quot;strategy&quot;:&quot;数据库&quot;,&quot;ab&quot;:&quot;new&quot;}" class="tag-link" href="https://www.csdn.net/gather_27/NtzaUgysMTg1NC1ibG9n.html" target="_blank" rel="noopener">数据库</a>
                                <a data-report-click="{&quot;mod&quot;:&quot;popu_626&quot;,&quot;spm&quot;:&quot;1001.2101.3001.4223&quot;,&quot;strategy&quot;:&quot;程序设计&quot;,&quot;ab&quot;:&quot;new&quot;}" class="tag-link" href="https://www.csdn.net/gather_26/MtTaEg1sMjA3NjUtYmxvZwO0O0OO0O0O.html" target="_blank" rel="noopener">程序设计</a>
                                <a data-report-click="{&quot;mod&quot;:&quot;popu_626&quot;,&quot;spm&quot;:&quot;1001.2101.3001.4223&quot;,&quot;strategy&quot;:&quot;tkinter&quot;,&quot;ab&quot;:&quot;new&quot;}" class="tag-link" href="https://www.csdn.net/gather_23/MtTaEg0sMDYxNTktYmxvZwO0O0OO0O0O.html" target="_blank" rel="noopener">tkinter</a>
                                <a data-report-click="{&quot;mod&quot;:&quot;popu_626&quot;,&quot;spm&quot;:&quot;1001.2101.3001.4223&quot;,&quot;strategy&quot;:&quot;mysql&quot;,&quot;ab&quot;:&quot;new&quot;}" class="tag-link" href="https://www.csdn.net/gather_25/MtTaEg5sOTYwNC1ibG9n.html" target="_blank" rel="noopener">mysql</a>
                                <a data-report-click="{&quot;mod&quot;:&quot;popu_626&quot;,&quot;spm&quot;:&quot;1001.2101.3001.4223&quot;,&quot;strategy&quot;:&quot;python&quot;,&quot;ab&quot;:&quot;new&quot;}" class="tag-link" href="https://www.csdn.net/gather_24/MtjaQg4sNDk0LWJsb2cO0O0O.html" target="_blank" rel="noopener">python</a>
                    </div>
                </div>
                <div class="up-time"><span>最后发布:2020-12-04 17:51:01</span><span>首次发布:2020-12-04 17:51:01</span></div>
                <div class="slide-content-box">
                    <div class="article-copyright">
                        <div class="creativecommons">
                            版权声明：本文为博主原创文章，遵循<a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" rel="noopener"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。
                        </div>
                        <div class="article-source-link">
                            本文链接：<a href="https://blog.csdn.net/cnmlgbnbcs/article/details/110643393" target="_blank">https://blog.csdn.net/cnmlgbnbcs/article/details/110643393</a>
                        </div>
                    </div>
                </div>
                <div class="operating">
                    <a class="href-article-edit slide-toggle">版权</a>
                </div>
            </div>
        </div>
    </div>
    <article class="baidu_pl">
        <div id="article_content" class="article_content clearfix">
        <link rel="stylesheet" href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/ck_htmledit_views-b5506197d8.css">
                <div id="content_views" class="markdown_views prism-atom-one-dark">
                    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <path stroke-linecap="round" d="M5,0 0,2.5 5,5z" id="raphael-marker-block" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></path>
                    </svg>
                    <p></p>
<div class="toc">
 <h3><a name="t0"></a><a name="t0"></a>文章目录</h3>
 <ul><li><a href="#_6" target="_self">前言</a></li><li><a href="#library_10" target="_self">二、建立数据库library</a></li><li><ul><li><a href="#21_book_13" target="_self">2.1 book表</a></li><li><a href="#22_borrow_16" target="_self">2.2 borrow表</a></li><li><a href="#23__user_19" target="_self">2.3 user表</a></li></ul>
  </li><li><a href="#_23" target="_self">三、各个模块介绍</a></li><li><ul><li><a href="#31_initial_25" target="_self">3.1 初始界面initial</a></li><li><a href="#32__manager_70" target="_self">3.2 manager登录注册模块</a></li><li><a href="#33_ID_151" target="_self">3.3 ID模块</a></li><li><a href="#34_reader_233" target="_self">3.4 reader登录注册模块</a></li><li><a href="#35__m_operation_310" target="_self">3.5 m_operation管理员操作界面</a></li><li><a href="#36__r_operation_415" target="_self">3.6 r_operation读者操作模块</a></li><li><a href="#37_search_547" target="_self">3.7 search模块（动态查询）</a></li></ul>
  </li><li><a href="#_632" target="_self">四、总结</a></li></ul>
</div>
<p></p> 
<hr color="#000000" size="1&quot;"> 
<h1><a name="t1"></a><a name="t1"></a><a id="_6"></a>前言</h1> 
<p>大三上学期的程序设计实训大作业，挑了其中一个我认为最简单的的《图书管理系统》来写。用python写是因为py有自带的GUI，即tkinter模块，对初次接触GUI的新手会比较友好。编译器我用的是Pycharm,你需要检查你的编译器是否带了tkinter模块和pymysql模块，没有的话需要下载安装，具体方法可以百度，很简单。界面很丑，凑合看哦！如果你没有了解过tkinter，建议先去知乎，csdn上面搜索自学一下入门教程，这样就比较容易理解我的东西啦！<br> <img src="https://img-blog.csdnimg.cn/20201204154038892.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
<h1><a name="t2"></a><a name="t2"></a><a id="library_10"></a>二、建立数据库library</h1> 
<p><img src="https://img-blog.csdnimg.cn/20201204154132303.png" alt="在这里插入图片描述"><br> 如图所示，软件是Navicat，给library建表。</p> 
<h2><a name="t3"></a><a name="t3"></a><a id="21_book_13"></a>2.1 book表</h2> 
<p>存储图书的相关信息，包括书名，作者，类型，数量。主码是name和author。<br> <img src="https://img-blog.csdnimg.cn/20201204155059392.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
<h2><a name="t4"></a><a name="t4"></a><a id="22_borrow_16"></a>2.2 borrow表</h2> 
<p>借书单，存储借书人ID，书名，作者，借书时间。主码是name和author。<br> <img src="https://img-blog.csdnimg.cn/20201204155307583.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
<h2><a name="t5"></a><a name="t5"></a><a id="23__user_19"></a>2.3 user表</h2> 
<p>使用者，包括ID,password，job是个只有1位的数字，0表示读者，1表示管理员，登录的时候通过检测其job然后选择是跳转到读者界面还是管理员界面。<br> <img src="https://img-blog.csdnimg.cn/20201204173350758.png" alt="在这里插入图片描述"></p> 
<h1><a name="t6"></a><a name="t6"></a><a id="_23"></a>三、各个模块介绍</h1> 
<p><img src="https://img-blog.csdnimg.cn/2020120415452737.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
<h2><a name="t7"></a><a name="t7"></a><a id="31_initial_25"></a>3.1 初始界面initial</h2> 
<pre class="prettyprint"><code class="prism language-python has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">import</span> reader
<span class="token keyword">import</span> manager

<span class="token keyword">def</span> <span class="token function">frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#初始界面</span>
    <span class="token keyword">global</span> root
    root<span class="token operator">=</span>tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'900x700'</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'西电图书管理系统'</span><span class="token punctuation">)</span>
    lable0<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'欢迎来到XDU图书馆'</span><span class="token punctuation">,</span>bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#上</span>
	<span class="token comment">#canvas是个画布，想要插入图片的话首先要定义个canvas</span>
    canvas<span class="token operator">=</span>tk<span class="token punctuation">.</span>Canvas<span class="token punctuation">(</span>root<span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token comment">#中</span>
    image_file<span class="token operator">=</span>tk<span class="token punctuation">.</span>PhotoImage<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token operator">=</span><span class="token string">'2.gif'</span><span class="token punctuation">)</span>
    <span class="token comment">#图片文件的后缀必须是.gif，且亲测不能自行鼠标右键重命名更改成.gif，要用win10里内置的画图功能，打开图片然后另存为的时候选择.gif</span>
    <span class="token comment">#图片文件必须放到你的项目目录里边才有效</span>
    image<span class="token operator">=</span>canvas<span class="token punctuation">.</span>create_image<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span>image<span class="token operator">=</span>image_file<span class="token punctuation">)</span>
    canvas<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">170</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">170</span><span class="token punctuation">)</span>

    lable1<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'请选择用户类型:'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token comment">#下</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'读  者'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>command<span class="token operator">=</span>exit_reader<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">420</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'管理员'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>command<span class="token operator">=</span>exit_manager<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">550</span><span class="token punctuation">)</span>

    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#必须要有这句话，你的页面才会动态刷新循环，否则页面不会显示 </span>

<span class="token keyword">def</span> <span class="token function">exit_reader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#跳转至读者界面</span>
    root<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    reader<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">exit_manager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#跳转至管理员界面</span>
    root<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    manager<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    frame<span class="token punctuation">(</span><span class="token punctuation">)</span>

<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li></ul></pre> 
<p><img src="https://img-blog.csdnimg.cn/20201204160548297.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 效果就是上面这样的。<br> 这个初始界面就比较简单，点击读者跳转到读者界面，点击管理员跳转到管理员界面。</p> 
<h2><a name="t8"></a><a name="t8"></a><a id="32__manager_70"></a>3.2 manager登录注册模块</h2> 
<p>当我们从初始界面选择“管理员”，那么这时候调用exit_manager()函数，来到了管理员界面</p> 
<pre class="prettyprint"><code class="prism language-python has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">import</span> tkinter<span class="token punctuation">.</span>messagebox <span class="token keyword">as</span> msg <span class="token comment">#这个是会弹出一个警告/提示小框</span>
<span class="token keyword">import</span> initial
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> ID

<span class="token keyword">def</span> <span class="token function">frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#管理员界面</span>
    <span class="token keyword">global</span> root
    root<span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'900x700'</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'西电图书管理系统'</span><span class="token punctuation">)</span>
    lable0 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'管理员登录'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 上</span>

    canvas <span class="token operator">=</span> tk<span class="token punctuation">.</span>Canvas<span class="token punctuation">(</span>root<span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>  <span class="token comment"># 中</span>
    image_file <span class="token operator">=</span> tk<span class="token punctuation">.</span>PhotoImage<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token operator">=</span><span class="token string">'2.gif'</span><span class="token punctuation">)</span>
    image <span class="token operator">=</span> canvas<span class="token punctuation">.</span>create_image<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> image<span class="token operator">=</span>image_file<span class="token punctuation">)</span>
    canvas<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">190</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">170</span><span class="token punctuation">)</span>

    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'请选择:'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>  <span class="token comment"># 下</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'登录'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> command<span class="token operator">=</span>login<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'注册'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> command<span class="token operator">=</span>register<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'退出'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> command<span class="token operator">=</span>exit_manager<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">550</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#登录小窗口</span>
    <span class="token keyword">global</span> root1
    root1<span class="token operator">=</span>tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root1<span class="token punctuation">.</span>wm_attributes<span class="token punctuation">(</span><span class="token string">'-topmost'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment">#将登录窗口置顶不至于被遮到下面</span>
    root1<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'管理员登录'</span><span class="token punctuation">)</span>
    root1<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'500x300'</span><span class="token punctuation">)</span>

    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'账号：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    lable2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'密码：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> entry_name<span class="token punctuation">,</span> entry_key
    name<span class="token operator">=</span>tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    key <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>

    entry_name <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root1<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>name<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
    entry_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    entry_key <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root1<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>key<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span>show<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>
    entry_key<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token comment"># 百度：tkinter要求由按钮（或者其它的插件）触发的控制器函数不能含有参数,若要给函数传递参数，需要在函数前添加lambda：</span>
    button1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确定'</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> ID<span class="token punctuation">.</span>id_check<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    button1<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">210</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">)</span>
<span class="token comment">#当我们输入账号和密码，点击确定时候，会调用ID模块里的id_check()函数，1是参数，表示其身份是管理员</span>
<span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#注册小窗口</span>
    <span class="token keyword">global</span> root2
    root2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root2<span class="token punctuation">.</span>wm_attributes<span class="token punctuation">(</span><span class="token string">'-topmost'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    root2<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'管理员注册'</span><span class="token punctuation">)</span>
    root2<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'500x300'</span><span class="token punctuation">)</span>

    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'账号：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    lable2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'密码：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    lable2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确认密码：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> entry_name<span class="token punctuation">,</span> entry_key<span class="token punctuation">,</span> entry_confirm
    name <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    key <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    confirm <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    entry_name <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>name<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
    entry_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    entry_key <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>key<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> show<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>
    entry_key<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    entry_confirm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>confirm<span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> show<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>
    entry_confirm<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
    <span class="token comment"># 百度：tkinter要求由按钮（或者其它的插件）触发的控制器函数不能含有参数,若要给函数传递参数，需要在函数前添加lambda：</span>
    button1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确定'</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> ID<span class="token punctuation">.</span>id_write<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    button1<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">210</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
<span class="token comment">#当我们点击确定的时候，会调用ID模块里的id_write()函数，1是参数，表示其身份是管理员</span>
<span class="token keyword">def</span> <span class="token function">exit_manager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#退出管理员界面，跳转至初始界面</span>
    root<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    initial<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token punctuation">)</span>

<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li><li style="color: rgb(153, 153, 153);">70</li><li style="color: rgb(153, 153, 153);">71</li><li style="color: rgb(153, 153, 153);">72</li><li style="color: rgb(153, 153, 153);">73</li><li style="color: rgb(153, 153, 153);">74</li><li style="color: rgb(153, 153, 153);">75</li></ul></pre> 
<p><img src="https://img-blog.csdnimg.cn/20201204162729255.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> <img src="https://img-blog.csdnimg.cn/20201204162835153.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
<h2><a name="t9"></a><a name="t9"></a><a id="33_ID_151"></a>3.3 ID模块</h2> 
<p>ID模块相当于后端了，主要实现连接数据库，检查账号的有无，核对密码，注册等功能。</p> 
<pre class="prettyprint"><code class="prism language-python has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">import</span> tkinter<span class="token punctuation">.</span>messagebox <span class="token keyword">as</span> msg
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> initial
<span class="token keyword">import</span> manager
<span class="token keyword">import</span> reader
<span class="token keyword">import</span> m_operation
<span class="token keyword">import</span> r_operation
<span class="token keyword">def</span> <span class="token function">id_check</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#检查账号</span>
    <span class="token keyword">global</span> <span class="token builtin">id</span>
    <span class="token keyword">if</span> a <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span><span class="token comment">#在管理员界面下登录，参数是1</span>
    <span class="token comment">#把账号/密码框框里输入的字符串赋值给id/password</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> manager<span class="token punctuation">.</span>entry_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> manager<span class="token punctuation">.</span>entry_key<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span><span class="token comment">#在读者界面下登录，参数是0</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> reader<span class="token punctuation">.</span>entry_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> reader<span class="token punctuation">.</span>entry_key<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
    getid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#最后得到id</span>
    <span class="token comment">#连接数据库，root是你数据库的用户名，应该是默认的是root，qwer是你数据库的密码，library是你要连接的数据库名字</span>
    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"qwer"</span><span class="token punctuation">,</span> <span class="token string">"library"</span><span class="token punctuation">)</span>
    <span class="token comment">#建立游标cursor，这个游标可以类比指针，这样理解比较直观</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sql <span class="token operator">=</span> <span class="token string">"SELECT password FROM user WHERE id='%s' AND job='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span> <span class="token comment">#sql语句被执行</span>
    result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#得到的结果返回给result数组</span>
    <span class="token keyword">if</span> result<span class="token punctuation">:</span><span class="token comment">#如果查询到了账号存在</span>
            <span class="token keyword">if</span> password <span class="token operator">==</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token comment">#result[0]是数组中的第一个结果</span>
                success_login<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token comment">#密码对上了，进入对应的读者/管理员操作界面</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span><span class="token comment">#有账号但密码没对上</span>
               msg<span class="token punctuation">.</span>_show<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'错误！'</span><span class="token punctuation">,</span>message<span class="token operator">=</span><span class="token string">'账号或密码输入错误！'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span><span class="token comment">#没有账号</span>
        msg<span class="token punctuation">.</span>_show<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'错误！'</span><span class="token punctuation">,</span>message<span class="token operator">=</span><span class="token string">'您输入的用户不存在！请先注册！'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> a<span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>
            manager<span class="token punctuation">.</span>root1<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#关闭登录小窗口，回到管理员界面</span>
        <span class="token keyword">elif</span> a<span class="token operator">==</span><span class="token string">'0'</span><span class="token punctuation">:</span>
            reader<span class="token punctuation">.</span>root1<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#查询完一定要关闭数据库啊</span>

<span class="token keyword">def</span> <span class="token function">success_login</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#成功登录</span>
    <span class="token keyword">if</span> a <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
        manager<span class="token punctuation">.</span>root1<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        m_operation<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#销毁登录注册界面，跳转到管理员的操作界面</span>

    <span class="token keyword">elif</span> a <span class="token operator">==</span> <span class="token string">'0'</span><span class="token punctuation">:</span>
        reader<span class="token punctuation">.</span>root1<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
        r_operation<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#销毁登录注册界面，跳转到读者的操作界面</span>

<span class="token keyword">def</span> <span class="token function">id_write</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#写入（注册）账号</span>
    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"qwer"</span><span class="token punctuation">,</span> <span class="token string">"library"</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> a<span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span><span class="token comment">#跟check函数里边十分类似</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> manager<span class="token punctuation">.</span>entry_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#得到输入的账号</span>
        password <span class="token operator">=</span> manager<span class="token punctuation">.</span>entry_key<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#得到输入的密码</span>
        confirm <span class="token operator">=</span> manager<span class="token punctuation">.</span>entry_confirm<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#得到输入的确认密码</span>
    <span class="token keyword">elif</span> a<span class="token operator">==</span><span class="token string">'0'</span><span class="token punctuation">:</span>
        <span class="token builtin">id</span> <span class="token operator">=</span> reader<span class="token punctuation">.</span>entry_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> reader<span class="token punctuation">.</span>entry_key<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>
        confirm <span class="token operator">=</span> reader<span class="token punctuation">.</span>entry_confirm<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span>

    sql0 <span class="token operator">=</span> <span class="token string">"SELECT id FROM user WHERE id='%s' AND job='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span>
    sql1 <span class="token operator">=</span> <span class="token string">"INSERT INTO user VALUES(%s,%s,%s) "</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">,</span> password<span class="token punctuation">,</span> a<span class="token punctuation">)</span>
<span class="token comment">#首先检查两次输入的密码是否一致，一致后再检查注册的账号是否已经存在</span>
    <span class="token keyword">if</span> password <span class="token operator">==</span> confirm<span class="token punctuation">:</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql0<span class="token punctuation">)</span>
        result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> result<span class="token punctuation">:</span>
            msg<span class="token punctuation">.</span>showerror<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'错误！'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'该账号已被注册，请重新输入！'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql1<span class="token punctuation">)</span>
            db<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'成功！'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'注册成功，请登录！'</span><span class="token punctuation">)</span>

    <span class="token keyword">else</span><span class="token punctuation">:</span>
        msg<span class="token punctuation">.</span>showerror<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'错误！'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'两次密码不一致，请重新输入！'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">getid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">id</span>
<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li><li style="color: rgb(153, 153, 153);">70</li><li style="color: rgb(153, 153, 153);">71</li><li style="color: rgb(153, 153, 153);">72</li><li style="color: rgb(153, 153, 153);">73</li><li style="color: rgb(153, 153, 153);">74</li><li style="color: rgb(153, 153, 153);">75</li><li style="color: rgb(153, 153, 153);">76</li><li style="color: rgb(153, 153, 153);">77</li><li style="color: rgb(153, 153, 153);">78</li></ul></pre> 
<h2><a name="t10"></a><a name="t10"></a><a id="34_reader_233"></a>3.4 reader登录注册模块</h2> 
<p>同2.2，如法炮（pao二声）制。<br> （咳咳学好语文也好重要呀！）</p> 
<pre class="prettyprint"><code class="prism language-python has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">import</span> initial
<span class="token keyword">import</span> ID
<span class="token keyword">def</span> <span class="token function">frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> root
    root<span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'900x700'</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'西电图书管理系统'</span><span class="token punctuation">)</span>
    lable0 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'读者登录'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 上</span>

    canvas <span class="token operator">=</span> tk<span class="token punctuation">.</span>Canvas<span class="token punctuation">(</span>root<span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>  <span class="token comment"># 中</span>
    image_file <span class="token operator">=</span> tk<span class="token punctuation">.</span>PhotoImage<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token operator">=</span><span class="token string">'2.gif'</span><span class="token punctuation">)</span>
    image <span class="token operator">=</span> canvas<span class="token punctuation">.</span>create_image<span class="token punctuation">(</span><span class="token number">250</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> image<span class="token operator">=</span>image_file<span class="token punctuation">)</span>
    canvas<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">190</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">170</span><span class="token punctuation">)</span>

    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'请选择:'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>  <span class="token comment"># 下</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'登录'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> command<span class="token operator">=</span>login<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'注册'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> command<span class="token operator">=</span>register<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'退出'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> command<span class="token operator">=</span>exit_reader<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">550</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">)</span>
    root<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> root1
    root1<span class="token operator">=</span>tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root1<span class="token punctuation">.</span>wm_attributes<span class="token punctuation">(</span><span class="token string">'-topmost'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    root1<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'读者登录'</span><span class="token punctuation">)</span>
    root1<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'500x300'</span><span class="token punctuation">)</span>

    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'账号：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    lable2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root1<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'密码：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> entry_name<span class="token punctuation">,</span> entry_key
    name<span class="token operator">=</span>tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    key <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>

    entry_name<span class="token operator">=</span>tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root1<span class="token punctuation">,</span>textvariable<span class="token operator">=</span>name<span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
    entry_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    entry_key<span class="token operator">=</span>tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root1<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>key<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span>show<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>
    entry_key<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token comment"># 百度：tkinter要求由按钮（或者其它的插件）触发的控制器函数不能含有参数,若要给函数传递参数，需要在函数前添加lambda</span>
    button1<span class="token operator">=</span>tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root1<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'确定'</span><span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>command<span class="token operator">=</span><span class="token keyword">lambda</span> <span class="token punctuation">:</span>ID<span class="token punctuation">.</span>id_check<span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    button1<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">210</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> root2
    root2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    root2<span class="token punctuation">.</span>wm_attributes<span class="token punctuation">(</span><span class="token string">'-topmost'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    root2<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'读者注册'</span><span class="token punctuation">)</span>
    root2<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'500x300'</span><span class="token punctuation">)</span>

    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'账号：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    lable2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'密码：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    lable2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确认密码：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> entry_name<span class="token punctuation">,</span> entry_key<span class="token punctuation">,</span> entry_confirm
    name <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    key <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    confirm <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    entry_name <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>name<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
    entry_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span>
    entry_key <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>key<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> show<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>
    entry_key<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    entry_confirm <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>confirm<span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> show<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>
    entry_confirm<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">180</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
    <span class="token comment"># 百度：tkinter要求由按钮（或者其它的插件）触发的控制器函数不能含有参数,若要给函数传递参数，需要在函数前添加lambda</span>
    button1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>root2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确定'</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> command<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token punctuation">:</span> ID<span class="token punctuation">.</span>id_write<span class="token punctuation">(</span><span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    button1<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">210</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">exit_reader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#退出管理员界面，跳转至初始界面</span>
    root<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
    initial<span class="token punctuation">.</span>frame<span class="token punctuation">(</span><span class="token punctuation">)</span>

<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li><li style="color: rgb(153, 153, 153);">70</li><li style="color: rgb(153, 153, 153);">71</li><li style="color: rgb(153, 153, 153);">72</li></ul></pre> 
<h2><a name="t11"></a><a name="t11"></a><a id="35__m_operation_310"></a>3.5 m_operation管理员操作界面</h2> 
<p>当我们终于成功注册/登录之后，来到了管理员的操作界面。<br> <img src="https://img-blog.csdnimg.cn/20201204170243276.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
<pre class="prettyprint"><code class="prism language-python has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">import</span> tkinter<span class="token punctuation">.</span>messagebox <span class="token keyword">as</span> msg
<span class="token keyword">import</span> search
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> ttk
<span class="token keyword">import</span> pymysql
<span class="token keyword">def</span> <span class="token function">frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    window<span class="token operator">=</span>tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'管理员'</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'900x700'</span><span class="token punctuation">)</span>
    lable0 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'欢迎来到XDU图书馆'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 上</span>

    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'请选择操作:'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>  <span class="token comment"># 下</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'进购图书'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>command<span class="token operator">=</span>purchase<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'注销图书'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>command<span class="token operator">=</span>cancel<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'信息查询'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>command<span class="token operator">=</span>search<span class="token punctuation">.</span>frame<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">450</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">purchase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#进购图书</span>
    <span class="token keyword">global</span> win
    win <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'管理员'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'900x300'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>wm_attributes<span class="token punctuation">(</span><span class="token string">'-topmost'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'请填写进购图书的信息:'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'图书类目：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token keyword">global</span> <span class="token builtin">list</span><span class="token comment">#这个是一个下拉页表项，只能从下面的list['values']里边选</span>
    comvalue <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span> <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Combobox<span class="token punctuation">(</span>win<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>comvalue<span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'全部'</span><span class="token punctuation">,</span> <span class="token string">'人文'</span><span class="token punctuation">,</span> <span class="token string">'艺术'</span><span class="token punctuation">,</span> <span class="token string">'计算机'</span><span class="token punctuation">,</span> <span class="token string">'科技'</span><span class="token punctuation">,</span> <span class="token string">'杂志'</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token comment">#默认显示'全部'</span>

    <span class="token keyword">global</span> b_name
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'书名：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    b_name <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    b_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> author
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'作者：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    author <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    author<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> price
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'价格：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">460</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    price <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    price<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">510</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> amount
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'数量：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">560</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    amount <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
    amount<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">610</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确认添加'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> command<span class="token operator">=</span>add<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">700</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">195</span><span class="token punctuation">)</span>
    
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#添加图书信息到数据库中</span>
    sql<span class="token operator">=</span><span class="token string">"INSERT INTO book VALUES('%s','%s','%s','%s','%s')"</span><span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>price<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>amount<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"qwer"</span><span class="token punctuation">,</span> <span class="token string">"library"</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#这句不可或缺，当我们修改数据完成后必须要确认才能真正作用到数据库里</span>
    db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'成功！'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'新书已入库！'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#撤销图书</span>
    <span class="token keyword">global</span> win
    win <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'管理员'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'900x300'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>wm_attributes<span class="token punctuation">(</span><span class="token string">'-topmost'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'请填写注销图书的信息:'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'图书类目：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token keyword">global</span> <span class="token builtin">list</span>
    comvalue <span class="token operator">=</span> tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span> <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Combobox<span class="token punctuation">(</span>win<span class="token punctuation">,</span> textvariable<span class="token operator">=</span>comvalue<span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'全部'</span><span class="token punctuation">,</span> <span class="token string">'人文'</span><span class="token punctuation">,</span> <span class="token string">'艺术'</span><span class="token punctuation">,</span> <span class="token string">'计算机'</span><span class="token punctuation">,</span> <span class="token string">'科技'</span><span class="token punctuation">,</span> <span class="token string">'杂志'</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> b_name
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'书名：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    b_name <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    b_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> author
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'作者：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    author <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    author<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确认注销'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> command<span class="token operator">=</span>delete<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">195</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>删除图书
    sql <span class="token operator">=</span> <span class="token string">"DELETE FROM book WHERE type='%s' AND name='%s' AND author='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"qwer"</span><span class="token punctuation">,</span> <span class="token string">"library"</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#这句不可或缺，当我们修改数据完成后必须要确认才能真正作用到数据库里</span>
    msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'成功！'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'该书已删除！'</span><span class="token punctuation">)</span>

<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li><li style="color: rgb(153, 153, 153);">70</li><li style="color: rgb(153, 153, 153);">71</li><li style="color: rgb(153, 153, 153);">72</li><li style="color: rgb(153, 153, 153);">73</li><li style="color: rgb(153, 153, 153);">74</li><li style="color: rgb(153, 153, 153);">75</li><li style="color: rgb(153, 153, 153);">76</li><li style="color: rgb(153, 153, 153);">77</li><li style="color: rgb(153, 153, 153);">78</li><li style="color: rgb(153, 153, 153);">79</li><li style="color: rgb(153, 153, 153);">80</li><li style="color: rgb(153, 153, 153);">81</li><li style="color: rgb(153, 153, 153);">82</li><li style="color: rgb(153, 153, 153);">83</li><li style="color: rgb(153, 153, 153);">84</li><li style="color: rgb(153, 153, 153);">85</li><li style="color: rgb(153, 153, 153);">86</li><li style="color: rgb(153, 153, 153);">87</li><li style="color: rgb(153, 153, 153);">88</li><li style="color: rgb(153, 153, 153);">89</li><li style="color: rgb(153, 153, 153);">90</li><li style="color: rgb(153, 153, 153);">91</li><li style="color: rgb(153, 153, 153);">92</li><li style="color: rgb(153, 153, 153);">93</li><li style="color: rgb(153, 153, 153);">94</li><li style="color: rgb(153, 153, 153);">95</li><li style="color: rgb(153, 153, 153);">96</li><li style="color: rgb(153, 153, 153);">97</li><li style="color: rgb(153, 153, 153);">98</li><li style="color: rgb(153, 153, 153);">99</li></ul></pre> 
<p><img src="https://img-blog.csdnimg.cn/20201204171954892.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p> 
<h2><a name="t12"></a><a name="t12"></a><a id="36__r_operation_415"></a>3.6 r_operation读者操作模块</h2> 
<p>如2.5，如法炮制。但是要引入py内置的datetime模块</p> 
<pre class="prettyprint"><code class="prism language-python has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">import</span> tkinter<span class="token punctuation">.</span>messagebox <span class="token keyword">as</span> msg
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> ttk
<span class="token keyword">import</span> search
<span class="token keyword">import</span> ID
<span class="token keyword">import</span> datetime <span class="token keyword">as</span> dt<span class="token comment">#datetime</span>
<span class="token keyword">import</span> pymysql

<span class="token keyword">def</span> <span class="token function">frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    window2<span class="token operator">=</span>tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    window2<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'读者'</span><span class="token punctuation">)</span>
    window2<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'700x600'</span><span class="token punctuation">)</span>
    lable0 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'欢迎来到XDU图书馆'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>pack<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 上</span>

    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'请选择操作:'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>  <span class="token comment"># 下</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">' 借  书'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>command<span class="token operator">=</span>borrow<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">' 还  书'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>command<span class="token operator">=</span>turnback<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">)</span>
    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window2<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'信息查询'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span>command<span class="token operator">=</span>search<span class="token punctuation">.</span>frame<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">450</span><span class="token punctuation">)</span>
    window2<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> win
    win <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'读者'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'900x300'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>wm_attributes<span class="token punctuation">(</span><span class="token string">'-topmost'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
    lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'请填写所借图书的信息:(书名作者都要填写正确无误！)'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> b_name
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'书名：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    b_name <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    b_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">250</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> author
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'作者：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">350</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>
    author <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    author<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">)</span>

    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确认借书'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> command<span class="token operator">=</span>confirm_borrow<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">600</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">195</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">confirm_borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"qwer"</span><span class="token punctuation">,</span> <span class="token string">"library"</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sql0<span class="token operator">=</span><span class="token string">"SELECT amount FROM book WHERE name='%s' AND author='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql0<span class="token punctuation">)</span>
    result<span class="token operator">=</span>cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> result<span class="token punctuation">:</span>
        <span class="token keyword">if</span> result <span class="token operator">!=</span> <span class="token string">'0'</span><span class="token punctuation">:</span>
            time <span class="token operator">=</span> dt<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%F'</span><span class="token punctuation">)</span><span class="token comment">#得到的时间不是字符串型，我们要把时间转化成字符串型</span>
            sql <span class="token operator">=</span> <span class="token string">"INSERT INTO borrow VALUES('%s','%s','%s','%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>ID<span class="token punctuation">.</span>getid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>time<span class="token punctuation">)</span>
            sql1<span class="token operator">=</span><span class="token string">"UPDATE book SET amount=amount-1 WHERE name='%s' AND author='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql1<span class="token punctuation">)</span>
            db<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'成功！'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'借书成功！请一个月之内归还'</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'失败！'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'您借的书库存不足！'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'错误！'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'未找到该书！'</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">turnback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#还书</span>
    <span class="token keyword">global</span> win
    win <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'读者'</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'550x600'</span><span class="token punctuation">)</span>

    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"qwer"</span><span class="token punctuation">,</span> <span class="token string">"library"</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sql0 <span class="token operator">=</span> <span class="token string">"SELECT COUNT(*) FROM borrow WHERE id='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>ID<span class="token punctuation">.</span>getid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql0<span class="token punctuation">)</span>
    result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
        msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'错误'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'您还没借过书呢！'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token punctuation">:</span>
        lable1 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'查询到您有以下书目未还：'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>
        tree <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Treeview<span class="token punctuation">(</span>win<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> show<span class="token operator">=</span><span class="token string">"headings"</span><span class="token punctuation">)</span>
        tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
        tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
        tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'书名'</span><span class="token punctuation">)</span>
        tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'作者'</span><span class="token punctuation">)</span>
        tree<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>

        sql1 <span class="token operator">=</span> <span class="token string">"SELECT bookname,author FROM borrow WHERE id='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>ID<span class="token punctuation">.</span>getid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql1<span class="token punctuation">)</span>
        result1 <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            tree<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> values<span class="token operator">=</span><span class="token punctuation">(</span>result1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        lable2 <span class="token operator">=</span> tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'请输入还书信息：'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">360</span><span class="token punctuation">)</span>
        lable22<span class="token operator">=</span>tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'书名作者都要填写正确无误！'</span><span class="token punctuation">,</span> bg<span class="token operator">=</span><span class="token string">'pink'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'微软雅黑'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">400</span><span class="token punctuation">)</span>
        <span class="token keyword">global</span> b_name
        tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'书名：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">480</span><span class="token punctuation">)</span>
        b_name <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        b_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">130</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">480</span><span class="token punctuation">)</span>

        <span class="token keyword">global</span> author
        tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'作者：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">230</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">480</span><span class="token punctuation">)</span>
        author <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>win<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
        author<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">280</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">480</span><span class="token punctuation">)</span>

        tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>win<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'确认还书'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> command<span class="token operator">=</span>confirm_turnback<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">395</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">480</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">confirm_turnback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"qwer"</span><span class="token punctuation">,</span> <span class="token string">"library"</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>

    sql1 <span class="token operator">=</span> <span class="token string">"UPDATE book SET amount=amount+1 WHERE name='%s' AND author='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql1<span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    time1<span class="token operator">=</span>dt<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#获取现在的时间</span>
    sql2<span class="token operator">=</span><span class="token string">"SELECT date FROM borrow WHERE bookname='%s' AND author='%s'"</span><span class="token operator">%</span><span class="token punctuation">(</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql2<span class="token punctuation">)</span>
    result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>
    day<span class="token operator">=</span><span class="token punctuation">(</span>time1<span class="token operator">-</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>days<span class="token comment">#得到时间差，检查图书是否超期</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>day<span class="token punctuation">)</span>
    <span class="token keyword">if</span> day<span class="token operator">&gt;</span><span class="token number">30</span><span class="token punctuation">:</span>
        msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'还书成功'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'还书成功，但您已经超期！请下次按时归还'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        msg<span class="token punctuation">.</span>showinfo<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">'还书成功'</span><span class="token punctuation">,</span> message<span class="token operator">=</span><span class="token string">'还书成功，且未超过30天'</span><span class="token punctuation">)</span>

    sql0 <span class="token operator">=</span> <span class="token string">"DELETE FROM borrow WHERE bookname='%s' AND author='%s'"</span><span class="token operator">%</span><span class="token punctuation">(</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql0<span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    win<span class="token punctuation">.</span>destroy<span class="token punctuation">(</span><span class="token punctuation">)</span>
<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li><li style="color: rgb(153, 153, 153);">70</li><li style="color: rgb(153, 153, 153);">71</li><li style="color: rgb(153, 153, 153);">72</li><li style="color: rgb(153, 153, 153);">73</li><li style="color: rgb(153, 153, 153);">74</li><li style="color: rgb(153, 153, 153);">75</li><li style="color: rgb(153, 153, 153);">76</li><li style="color: rgb(153, 153, 153);">77</li><li style="color: rgb(153, 153, 153);">78</li><li style="color: rgb(153, 153, 153);">79</li><li style="color: rgb(153, 153, 153);">80</li><li style="color: rgb(153, 153, 153);">81</li><li style="color: rgb(153, 153, 153);">82</li><li style="color: rgb(153, 153, 153);">83</li><li style="color: rgb(153, 153, 153);">84</li><li style="color: rgb(153, 153, 153);">85</li><li style="color: rgb(153, 153, 153);">86</li><li style="color: rgb(153, 153, 153);">87</li><li style="color: rgb(153, 153, 153);">88</li><li style="color: rgb(153, 153, 153);">89</li><li style="color: rgb(153, 153, 153);">90</li><li style="color: rgb(153, 153, 153);">91</li><li style="color: rgb(153, 153, 153);">92</li><li style="color: rgb(153, 153, 153);">93</li><li style="color: rgb(153, 153, 153);">94</li><li style="color: rgb(153, 153, 153);">95</li><li style="color: rgb(153, 153, 153);">96</li><li style="color: rgb(153, 153, 153);">97</li><li style="color: rgb(153, 153, 153);">98</li><li style="color: rgb(153, 153, 153);">99</li><li style="color: rgb(153, 153, 153);">100</li><li style="color: rgb(153, 153, 153);">101</li><li style="color: rgb(153, 153, 153);">102</li><li style="color: rgb(153, 153, 153);">103</li><li style="color: rgb(153, 153, 153);">104</li><li style="color: rgb(153, 153, 153);">105</li><li style="color: rgb(153, 153, 153);">106</li><li style="color: rgb(153, 153, 153);">107</li><li style="color: rgb(153, 153, 153);">108</li><li style="color: rgb(153, 153, 153);">109</li><li style="color: rgb(153, 153, 153);">110</li><li style="color: rgb(153, 153, 153);">111</li><li style="color: rgb(153, 153, 153);">112</li><li style="color: rgb(153, 153, 153);">113</li><li style="color: rgb(153, 153, 153);">114</li><li style="color: rgb(153, 153, 153);">115</li><li style="color: rgb(153, 153, 153);">116</li><li style="color: rgb(153, 153, 153);">117</li><li style="color: rgb(153, 153, 153);">118</li><li style="color: rgb(153, 153, 153);">119</li><li style="color: rgb(153, 153, 153);">120</li><li style="color: rgb(153, 153, 153);">121</li><li style="color: rgb(153, 153, 153);">122</li><li style="color: rgb(153, 153, 153);">123</li><li style="color: rgb(153, 153, 153);">124</li><li style="color: rgb(153, 153, 153);">125</li><li style="color: rgb(153, 153, 153);">126</li><li style="color: rgb(153, 153, 153);">127</li><li style="color: rgb(153, 153, 153);">128</li></ul></pre> 
<h2><a name="t13"></a><a name="t13"></a><a id="37_search_547"></a>3.7 search模块（动态查询）</h2> 
<p>由于管理员和读者都有查询图书的功能，故为了减少代码，尽量代码重用，将该功能做成模块。search中要有动态查询，即查询条件的个数是可以改变的。<br> <img src="https://img-blog.csdnimg.cn/20201204173139367.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NubWxnYm5iY3M=,size_16,color_FFFFFF,t_70" alt=""></p> 
<pre class="prettyprint"><code class="prism language-py has-numbering" onclick="mdcp.signin(event)" style="position: unset;"><span class="token keyword">import</span> tkinter <span class="token keyword">as</span> tk
<span class="token keyword">import</span> tkinter<span class="token punctuation">.</span>messagebox <span class="token keyword">as</span> msg
<span class="token keyword">from</span> tkinter <span class="token keyword">import</span> ttk
<span class="token keyword">import</span> pymysql

<span class="token keyword">def</span> <span class="token function">frame</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> window
    window <span class="token operator">=</span> tk<span class="token punctuation">.</span>Tk<span class="token punctuation">(</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'图书查询'</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>geometry<span class="token punctuation">(</span><span class="token string">'1200x700'</span><span class="token punctuation">)</span>

    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'图书类目：'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">220</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> <span class="token builtin">list</span>
    comvalue<span class="token operator">=</span>tk<span class="token punctuation">.</span>StringVar<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token operator">=</span>ttk<span class="token punctuation">.</span>Combobox<span class="token punctuation">(</span>window<span class="token punctuation">,</span>textvariable<span class="token operator">=</span>comvalue<span class="token punctuation">,</span>height<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">300</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">[</span><span class="token string">'values'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'全部'</span><span class="token punctuation">,</span><span class="token string">'人文'</span><span class="token punctuation">,</span><span class="token string">'艺术'</span><span class="token punctuation">,</span><span class="token string">'计算机'</span><span class="token punctuation">,</span><span class="token string">'科技'</span><span class="token punctuation">,</span><span class="token string">'杂志'</span><span class="token punctuation">)</span>
    <span class="token builtin">list</span><span class="token punctuation">.</span>current<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> b_name
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'书名：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">450</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
    b_name<span class="token operator">=</span>tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>window<span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span>width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
    b_name<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">500</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>

    <span class="token keyword">global</span> author
    tk<span class="token punctuation">.</span>Label<span class="token punctuation">(</span>window<span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'作者：'</span><span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">650</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>
    author <span class="token operator">=</span> tk<span class="token punctuation">.</span>Entry<span class="token punctuation">(</span>window<span class="token punctuation">,</span> font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
    author<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">700</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>

    tk<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>window<span class="token punctuation">,</span>text<span class="token operator">=</span><span class="token string">'搜索'</span><span class="token punctuation">,</span>font<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'宋体'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>command<span class="token operator">=</span>search<span class="token punctuation">)</span><span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">900</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">)</span>
    <span class="token keyword">global</span> tree<span class="token comment">#建立树形图</span>
    yscrollbar <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Scrollbar<span class="token punctuation">(</span>window<span class="token punctuation">,</span> orient<span class="token operator">=</span><span class="token string">'vertical'</span><span class="token punctuation">)</span><span class="token comment">#右边的滑动按钮</span>
    tree <span class="token operator">=</span> ttk<span class="token punctuation">.</span>Treeview<span class="token punctuation">(</span>window<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token string">'5'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> show<span class="token operator">=</span><span class="token string">"headings"</span><span class="token punctuation">,</span>yscrollcommand<span class="token operator">=</span>yscrollbar<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>column<span class="token punctuation">(</span><span class="token string">'5'</span><span class="token punctuation">,</span> width<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">,</span> anchor<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'类目'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'书名'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'作者'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span><span class="token string">'4'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'价格'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>heading<span class="token punctuation">(</span><span class="token string">'5'</span><span class="token punctuation">,</span> text<span class="token operator">=</span><span class="token string">'库存'</span><span class="token punctuation">)</span>
    tree<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">200</span><span class="token punctuation">,</span> y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
    yscrollbar<span class="token punctuation">.</span>place<span class="token punctuation">(</span>x<span class="token operator">=</span><span class="token number">955</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span>mainloop<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token comment">#我用了最原始的方法来动态查询</span>
    <span class="token keyword">if</span> <span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'全部'</span><span class="token operator">and</span> b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">''</span> <span class="token operator">and</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">''</span> <span class="token punctuation">:</span>
        sql<span class="token operator">=</span><span class="token string">"SELECT * FROM book "</span>
    <span class="token keyword">elif</span> <span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'全部'</span><span class="token operator">and</span> b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">''</span> <span class="token operator">and</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token string">''</span> <span class="token punctuation">:</span>
        sql<span class="token operator">=</span><span class="token string">"SELECT * FROM book WHERE author='%s'"</span><span class="token operator">%</span><span class="token punctuation">(</span>author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'全部'</span><span class="token operator">and</span> b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token string">''</span> <span class="token operator">and</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">''</span> <span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM book WHERE name='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'全部'</span>  <span class="token operator">and</span> b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token string">''</span> <span class="token operator">and</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM book WHERE type='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token string">'全部'</span><span class="token operator">and</span> b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token string">''</span> <span class="token operator">and</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!=</span> <span class="token string">''</span> <span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM book WHERE name='%s' AND author='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'全部'</span> <span class="token operator">and</span> b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span><span class="token string">''</span> <span class="token operator">and</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM book WHERE type='%s' AND name='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> <span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'全部'</span> <span class="token operator">and</span> b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span><span class="token string">''</span> <span class="token operator">and</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">''</span> <span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM book WHERE type='%s' AND author ='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token punctuation">:</span>
        sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM book WHERE type='%s' AND name='%s' AND author ='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>b_name<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> author<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    db <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">"localhost"</span><span class="token punctuation">,</span> <span class="token string">"root"</span><span class="token punctuation">,</span> <span class="token string">"qwer"</span><span class="token punctuation">,</span> <span class="token string">"library"</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> db<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    results<span class="token operator">=</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> results<span class="token punctuation">:</span>
        l<span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#查询到的结果依次插入到表格中</span>
            tree<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span>values<span class="token operator">=</span><span class="token punctuation">(</span>results<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span> <span class="token punctuation">:</span>
        tree<span class="token punctuation">.</span>insert<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span>values<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'查询不到结果'</span><span class="token punctuation">,</span><span class="token string">'查询不到结果'</span><span class="token punctuation">,</span><span class="token string">'查询不到结果'</span><span class="token punctuation">,</span><span class="token string">'查询不到结果'</span><span class="token punctuation">,</span><span class="token string">'查询不到结果'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    db<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<div class="hljs-button signin" data-title="登录后复制" data-report-click="{&quot;spm&quot;:&quot;1001.2101.3001.4259&quot;}"></div></code><ul class="pre-numbering" style=""><li style="color: rgb(153, 153, 153);">1</li><li style="color: rgb(153, 153, 153);">2</li><li style="color: rgb(153, 153, 153);">3</li><li style="color: rgb(153, 153, 153);">4</li><li style="color: rgb(153, 153, 153);">5</li><li style="color: rgb(153, 153, 153);">6</li><li style="color: rgb(153, 153, 153);">7</li><li style="color: rgb(153, 153, 153);">8</li><li style="color: rgb(153, 153, 153);">9</li><li style="color: rgb(153, 153, 153);">10</li><li style="color: rgb(153, 153, 153);">11</li><li style="color: rgb(153, 153, 153);">12</li><li style="color: rgb(153, 153, 153);">13</li><li style="color: rgb(153, 153, 153);">14</li><li style="color: rgb(153, 153, 153);">15</li><li style="color: rgb(153, 153, 153);">16</li><li style="color: rgb(153, 153, 153);">17</li><li style="color: rgb(153, 153, 153);">18</li><li style="color: rgb(153, 153, 153);">19</li><li style="color: rgb(153, 153, 153);">20</li><li style="color: rgb(153, 153, 153);">21</li><li style="color: rgb(153, 153, 153);">22</li><li style="color: rgb(153, 153, 153);">23</li><li style="color: rgb(153, 153, 153);">24</li><li style="color: rgb(153, 153, 153);">25</li><li style="color: rgb(153, 153, 153);">26</li><li style="color: rgb(153, 153, 153);">27</li><li style="color: rgb(153, 153, 153);">28</li><li style="color: rgb(153, 153, 153);">29</li><li style="color: rgb(153, 153, 153);">30</li><li style="color: rgb(153, 153, 153);">31</li><li style="color: rgb(153, 153, 153);">32</li><li style="color: rgb(153, 153, 153);">33</li><li style="color: rgb(153, 153, 153);">34</li><li style="color: rgb(153, 153, 153);">35</li><li style="color: rgb(153, 153, 153);">36</li><li style="color: rgb(153, 153, 153);">37</li><li style="color: rgb(153, 153, 153);">38</li><li style="color: rgb(153, 153, 153);">39</li><li style="color: rgb(153, 153, 153);">40</li><li style="color: rgb(153, 153, 153);">41</li><li style="color: rgb(153, 153, 153);">42</li><li style="color: rgb(153, 153, 153);">43</li><li style="color: rgb(153, 153, 153);">44</li><li style="color: rgb(153, 153, 153);">45</li><li style="color: rgb(153, 153, 153);">46</li><li style="color: rgb(153, 153, 153);">47</li><li style="color: rgb(153, 153, 153);">48</li><li style="color: rgb(153, 153, 153);">49</li><li style="color: rgb(153, 153, 153);">50</li><li style="color: rgb(153, 153, 153);">51</li><li style="color: rgb(153, 153, 153);">52</li><li style="color: rgb(153, 153, 153);">53</li><li style="color: rgb(153, 153, 153);">54</li><li style="color: rgb(153, 153, 153);">55</li><li style="color: rgb(153, 153, 153);">56</li><li style="color: rgb(153, 153, 153);">57</li><li style="color: rgb(153, 153, 153);">58</li><li style="color: rgb(153, 153, 153);">59</li><li style="color: rgb(153, 153, 153);">60</li><li style="color: rgb(153, 153, 153);">61</li><li style="color: rgb(153, 153, 153);">62</li><li style="color: rgb(153, 153, 153);">63</li><li style="color: rgb(153, 153, 153);">64</li><li style="color: rgb(153, 153, 153);">65</li><li style="color: rgb(153, 153, 153);">66</li><li style="color: rgb(153, 153, 153);">67</li><li style="color: rgb(153, 153, 153);">68</li><li style="color: rgb(153, 153, 153);">69</li><li style="color: rgb(153, 153, 153);">70</li><li style="color: rgb(153, 153, 153);">71</li><li style="color: rgb(153, 153, 153);">72</li><li style="color: rgb(153, 153, 153);">73</li><li style="color: rgb(153, 153, 153);">74</li><li style="color: rgb(153, 153, 153);">75</li><li style="color: rgb(153, 153, 153);">76</li><li style="color: rgb(153, 153, 153);">77</li><li style="color: rgb(153, 153, 153);">78</li><li style="color: rgb(153, 153, 153);">79</li></ul></pre> 
<h1><a name="t14"></a><a name="t14"></a><a id="_632"></a>四、总结</h1> 
<p>这是一个较为简单的图书管理系统，其中仍有一些不足。比如人人都能注册管理员账号然后修改图书信息，这会造成系统的不安全。还有就是我们默认的读者借书时候会先查询图书信息，得到图书信息后填写的书名和作者必定是正确的，我没有加上相应的错误处理。然后读者借书超期后有惩罚措施，比如无法借书或限制借书的数量，这个我没有实现，仅仅是提醒了读者有图书已超期。如果有相关问题，欢迎私信作者共同探讨。</p> 
<p><font color="#999AAA">提示：转发应得到作者同意，注明出处。</font></p>
                </div><div><div></div></div>
                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/editerView/markdown_views-d7a94ec6ab.css" rel="stylesheet">
                <link href="https://csdnimg.cn/release/blogv2/dist/mdeditor/css/style-ba784fbaf8.css" rel="stylesheet">
        </div>
    </article>
</div>